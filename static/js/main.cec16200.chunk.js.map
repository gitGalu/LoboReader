{"version":3,"sources":["App/Components/InternetArchive.js","App/Components/Db.js","App/Components/Centered.js","App/Components/ItemMetadataListItem.js","App/Components/ItemDrawer.js","App/Routes/Browser.js","App/Routes/Collection.js","App/Routes/Reader.js","App/Components/About.js","App/Components/StandaloneWarning.js","App/App.js","index.js"],"names":["paramify","obj","URLSearchParams","toString","fetchJson","url","options","a","fetch","res","json","BookMetaAPI","this","API_BASE","identifier","Error","get","BookManifestAPI","ExpBookAPI","InternetArchive","SearchAPI","q","page","fields","buildQueryFromObject","reqParams","fl","output","encodedParams","qObject","Object","keys","map","key","Array","isArray","v","join","db","Dexie","version","stores","collection","acknowledgements","Centered","styled","display","justifyContent","alignItems","height","marginTop","marginBottom","marginRight","withRouter","props","renderRow","route","endEnhancer","mediaType","onEditClick","onClick","event","title","kind","KIND","secondary","size","SIZE","mini","renderEndEnhancer","mediatype","editable","overrides","Content","style","className","borderRadius","verticalAlign","objectPosition","width","minWidth","minHeight","objectFit","effect","src","to","onSelectItem","renderItem","ItemDrawer","forwardRef","ref","useState","drawerOpen","setDrawerOpen","setIdentifier","undefined","setTitle","useImperativeHandle","showDrawer","hideDrawer","isOpen","autoFocus","onClose","anchor","ANCHOR","bottom","auto","textAlign","maxHeight","buttons","i","push","disabled","buttonDisabled","buttonAction","buttonLabel","buttonCount","renderButtons","browserItems","setBrowserItems","setPage","initial","setInitial","hasMore","setHasMore","isSearch","setIsSearch","parentIdentifier","setParentIdentifier","currentExisting","setCurrentExisting","currentArchived","setCurrentArchived","history","useHistory","drawer","React","useRef","enqueue","useSnackbar","useEffect","match","params","searchQuery","id","location","pathname","reloadQuery","query","handleItemClick","item","then","dbItem","archived","current","addToCollection","console","log","add","read","showNotification","put","message","startEnhancer","ia","rows","sort","results","dox","response","docs","b","concat","numFound","length","catch","err","getLink","action","onSubmit","e","preventDefault","input","document","getElementById","value","blur","handleSearch","type","placeholder","compact","autoComplete","StartEnhancer","marginLeft","paddingLeft","paddingRight","color","fontSize","paddingTop","getHeader","index","startReading","readLater","dataLength","next","loader","Collection","reloadDb","filter","toArray","items","find","update","result","archiveItem","stopPropagation","handleEditClick","setIndex","open","setOpen","currentItem","setCurrentItem","prevAction","prevId","bookMetadata","itemId","pages","getImageItems","pageCount","numPages","padStart","w","window","innerWidth","h","innerHeight","updateIndex","pagenum","container","onIndexChange","onOpenChange","state","bind","showAnimationDuration","hideAnimationDuration","fullscreenEl","allowPanToNext","bgOpacity","pinchToClose","closeOnScroll","closeOnVerticalDrag","maxSpreadZoom","barsSize","top","timeToIdle","timeToIdleOutside","captionEl","arrowEl","zoomEl","tapToClose","tapToToggleControls","clickToCloseNonZoomable","getDoubleTapZoom","isMouseClick","preload","modal","theme","foreground","background","About","closeable","animate","default","role","ROLE","dialog","target","StandaloneWarning","alertdialog","matchMedia","matches","isStandalone","placement","PLACEMENT","Helmet","charSet","name","content","Root","$align","ALIGN","left","center","right","float","s","mode","MODE","radio","initialState","selected","isActive","activeClassName","tertiary","exact","path","component","Browser","Reader","ReactDOM","render","Styletron","LightTheme"],"mappings":"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","file":"static/js/main.cec16200.chunk.js","sourcesContent":["import fetch from \"node-fetch\";\n\nconst paramify = (obj) => new URLSearchParams(obj).toString();\n\nconst fetchJson = async function (url, options) {\n  const res = await fetch(url, options);\n  return await res.json();\n};\n\nclass BookMetaAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}`;\n    return fetchJson(url);\n  }\n  async metadata(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass BookManifestAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}/ia_manifest`;\n    return fetchJson(url);\n  }\n  async metadata(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass ExpBookAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}/pages`;\n    return fetchJson(url);\n  }\n  async pages(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass SearchAPI {\n  constructor() {\n    this.API_BASE = \"https://archive.org/advancedsearch.php\";\n  }\n  async get({ q = null, page = 1, fields = [\"identifier\"], ...options } = {}) {\n    if (!q) {\n      throw new Error(\"Missing required arg 'q'\");\n    }\n    if (typeof q == \"object\") {\n      q = this.buildQueryFromObject(q);\n    }\n    const reqParams = {\n      q,\n      page,\n      fl: fields,\n      ...options,\n      output: \"json\",\n    };\n    const encodedParams = paramify(reqParams);\n    const url = `${this.API_BASE}?${encodedParams}`;\n    return fetchJson(url);\n  }\n  async search(q) {\n    return await this.get({ q });\n  }\n  buildQueryFromObject(qObject) {\n    // Map dictionary to a key=val search query\n    return Object.keys(qObject)\n      .map((key) => {\n        if (Array.isArray(qObject[key])) {\n          return `${key}:( ${qObject[key].map((v) => `\"${v}\"`).join(\" OR \")} )`;\n        } else {\n          return `${key}:\"${qObject[key]}\"`;\n        }\n      })\n      .join(\" AND \");\n  }\n}\n\nconst InternetArchive = {\n  SearchAPI: new SearchAPI(),\n  ExpBookAPI: new ExpBookAPI(),\n  BookMetaAPI: new BookMetaAPI(),\n  BookManifestAPI: new BookManifestAPI()\n};\n\nexport default InternetArchive;","import Dexie from 'dexie';\n\nconst DATABASE_NAME = 'LoboReader';\nconst DATABASE_VERSION = 4;\n\nconst db = new Dexie(DATABASE_NAME);\n\ndb.version(DATABASE_VERSION).stores({\n    collection: 'id',\n    acknowledgements: 'id'\n});\n\nexport default db;","import { styled } from 'baseui';\n\nexport const Centered = styled('div', {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100%',\n    marginTop: '32px',\n    marginBottom: '24px',\n    marginRight: '24px',\n    height: '100%',\n  });\n\n  ","import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { ListItem } from 'baseui/list';\nimport { LazyLoadImage } from 'react-lazy-load-image-component'\nimport 'react-lazy-load-image-component/src/effects/opacity.css';\nimport { ChevronRight } from \"baseui/icon\";\nimport { Button, KIND, SIZE } from 'baseui/button';\n\nconst ItemMetadataListItem = (props) => {\n  const renderItem = (mediaType) => {\n    switch (mediaType) {\n      case 'collection':\n        return (\n          <Link to={\"/browse/\" + props.identifier}>\n            <div className=\"rowItem\">\n              {renderRow()}\n            </div>\n          </Link>\n        );\n      default:\n        return (\n          <div className=\"rowItem\" onClick={(event) => props.onSelectItem(event, props.identifier, props.title)}>\n            { renderRow()}\n          </div>\n        );\n    }\n  }\n\n  const renderEndEnhancer = (mediaType) => {\n    switch (mediaType) {\n      case 'collection':\n        return (<ChevronRight />);\n      default:\n        if (props.onEditClick) {\n          return (<Button onClick={(event) => props.onEditClick(event, props.identifier, props.title)}\n            kind={KIND.secondary}\n            size={SIZE.mini}>\n            Edit\n          </Button>);\n        }\n    }\n    return (<div />);\n  }\n\n  const renderRow = (route) => {\n    return (\n      <ListItem\n        key=\"{props.identifier}\"\n        endEnhancer={() => renderEndEnhancer(props.mediatype, props.editable)}\n        overrides={{\n          Content: {\n            style: {\n              'padding-left': '0px',\n              'margin-left': '0px',\n              'width': '100%'\n            }\n          }\n        }}>\n\n        <LazyLoadImage\n          className=\"listImg\"\n          style={{\n            borderRadius: '5px',\n            verticalAlign: 'middle',\n            objectPosition: '0% 0%',\n            width: '64px',\n            height: '36px',\n            minWidth: '64px',\n            minHeight: '36px',\n            objectFit: 'cover',\n          }}\n          effect=\"opacity\"\n          key={\"https://archive.org/services/img/\" + props.identifier}\n          src={\"https://archive.org/services/img/\" + props.identifier}\n          width={'64px'}\n        />\n        <div className=\"description\">\n          {props.title}\n        </div>\n      </ListItem>\n    )\n  }\n\n  return (\n    renderItem(props.mediatype)\n  )\n}\n\nexport default withRouter(ItemMetadataListItem);","import React, { useState, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport { Link, withRouter } from \"react-router-dom\";\nimport { ListItem } from 'baseui/list';\nimport { LazyLoadImage } from 'react-lazy-load-image-component'\nimport 'react-lazy-load-image-component/src/effects/opacity.css';\nimport { ChevronRight } from \"baseui/icon\";\nimport { Button, KIND, SIZE } from 'baseui/button';\nimport { H6 } from 'baseui/typography';\nimport { Drawer, ANCHOR } from \"baseui/drawer\";\n\nconst ItemDrawer = forwardRef((props, ref) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    // const [item, setItem] = useState();\n    const [identifier, setIdentifier] = useState(\"\");\n    const [title, setTitle] = useState(undefined);\n\n    useImperativeHandle(ref, () => {\n        return {\n            showDrawer: showDrawer,\n            hideDrawer: hideDrawer\n        }\n    });\n\n    const showDrawer = (identifier, title) => {\n        setIdentifier(identifier);\n        setTitle(title);\n        setDrawerOpen(true);\n    };\n\n    const hideDrawer = () => {\n        setDrawerOpen(false);\n    };\n\n    const renderButtons = () => {\n        let buttons = [];\n        for (let i = 0; i < props.buttonCount; i++) {\n            buttons.push(\n                <div>\n                    <Button\n                    disabled={(props.buttonDisabled == undefined) ? false : props.buttonDisabled(i, identifier, title)}\n                    onClick={() => props.buttonAction(i, identifier, title)}>\n                    {props.buttonLabel(i, identifier, title)}\n                </Button><br /><br />    \n                </div>\n            );\n        }\n        return buttons;\n    }\n\n    const getTitle = () => {\n        return (title != undefined ? title : '');\n    }\n\n    const getImgUrl = () => {\n        return (identifier != undefined ? 'https://archive.org/services/img/' + identifier : '');\n    }\n\n    return (\n        <Drawer\n            isOpen={drawerOpen}\n            autoFocus\n            onClose={() => setDrawerOpen(false)}\n            anchor={ANCHOR.bottom}\n            size={SIZE.auto}>\n\n            <div style={{ textAlign: 'center' }}>\n                <H6>{getTitle()}</H6>\n                <br />\n                <img\n                    src={getImgUrl()}\n                    style={{\n                        maxHeight: '175px',\n                        borderRadius: '5px',\n                        objectFit: 'cover'\n                    }}\n                />\n                <br /><br />\n                {renderButtons()}\n            </div>\n        </Drawer>\n    )\n});\n\nexport default ItemDrawer;","import React, { useState, useEffect } from 'react';\nimport { withRouter, useHistory } from \"react-router-dom\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { Search as SearchIcon } from 'baseui/icon';\nimport Check from 'baseui/icon/check';\nimport { SIZE } from \"baseui/input\";\nimport { StatefulInput } from 'baseui/input';\nimport { useSnackbar } from 'baseui/snackbar';\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport ia from \"../Components/InternetArchive\";\nimport db from '../Components/Db';\nimport { Centered } from '../Components/Centered';\nimport ItemMetadataListItem from '../Components/ItemMetadataListItem'\nimport ItemDrawer from '../Components/ItemDrawer';\n\nconst Browser = (props) => {\n  const [browserItems, setBrowserItems] = useState([]);\n  const [page, setPage] = useState(1);\n  const [initial, setInitial] = useState(true);\n  const [hasMore, setHasMore] = useState(true);\n  const [isSearch, setIsSearch] = useState(false);\n  const [parentIdentifier, setParentIdentifier] = useState(undefined);\n  const [currentExisting, setCurrentExisting] = useState(false);\n  const [currentArchived, setCurrentArchived] = useState(false);\n\n\n  const history = useHistory();\n  const drawer = React.useRef(null);\n  const { enqueue } = useSnackbar();\n\n  useEffect(() => {\n    setBrowserItems([]);\n    setPage(1);\n    setInitial(true);\n\n    if (props.match.params.searchQuery !== undefined) {\n      setIsSearch(true);\n      setParentIdentifier(props.match.params.searchQuery);\n    } else {\n      setIsSearch(false);\n      (props.match.params.id && props.match.params.id !== \"s\") ? setParentIdentifier(props.match.params.id) : setParentIdentifier(\"magazine_rack\");\n    }\n  }, [props.location.pathname]);\n\n  useEffect(() => {\n    setBrowserItems([]);\n    reloadQuery();\n  }, [parentIdentifier]);\n\n  const reloadQuery = () => {\n    setPage(1);\n    setInitial(true);\n    query();\n  }\n\n  const handleItemClick = async (event, item) => {\n    db.collection.get({ id: item.identifier })\n      .then((dbItem) => {\n        setCurrentExisting(dbItem !== undefined);\n        setCurrentArchived((dbItem !== undefined) ? dbItem.archived : false);\n        drawer.current.showDrawer(item.identifier, item.title);\n      });\n  }\n\n  const itemMetadataToListItem = (item) => {\n    return <ItemMetadataListItem\n      key={item.identifier}\n      title={item.title}\n      identifier={item.identifier}\n      mediatype={item.mediatype}\n      onSelectItem={(event) => handleItemClick(event, item)} />;\n  }\n\n  const startReading = (identifier, title) => {\n    addToCollection(identifier, title);\n    history.push(getLink(identifier, title));\n  }\n\n  const readLater = (identifier, title) => {\n    addToCollection(identifier, title);\n    drawer.current.hideDrawer();\n  }\n\n  const addToCollection = async (identifier, title) => {\n    const dbItem = await db.collection.get({ id: identifier });\n    console.log(\"DBITEM\");\n    console.log(dbItem);\n    if (dbItem === undefined) {\n      db.collection.add({\n        id: identifier,\n        title: title,\n        page: 0,\n        read: false,\n        archived: false\n      }, identifier)\n        .then(function (id) {\n          showNotification();\n        });\n    } else {\n      dbItem.archived = false;\n      db.collection.put(dbItem);\n    }\n  }\n\n  const showNotification = () => {\n    enqueue({\n      message: 'Item was added.',\n      startEnhancer: ({ size }) => <Check size={size} />\n    })\n  }\n\n  const query = () => {\n    if (parentIdentifier == undefined) {\n      return;\n    }\n\n    ia.SearchAPI.get({\n      q: isSearch ? '(\"' + parentIdentifier + '\") (collection:(\"magazine_rack\") AND mediatype:(collection OR texts))' : 'collection:(\"' + parentIdentifier + '\" AND mediatype:(collection OR texts))',\n      fields: ['identifier', 'title', 'mediatype', 'type', 'metadata'],\n      rows: 50,\n      page: page,\n      sort: ['mediatype asc', 'identifier asc']\n    }).then(results => {\n      let dox = results.response.docs;\n      dox.sort((a, b) => (a.title > b.title) ? 1 : ((b.title > a.title) ? -1 : 0))\n      dox.sort((a, b) => (a.mediaType > b.mediaType) ? 1 : ((b.mediaType > a.mediaType) ? -1 : 0))\n      dox = browserItems.concat(dox);\n      setBrowserItems(dox);\n      setHasMore(results.response.numFound > dox.length);\n      setInitial(false);\n      setPage(page + 1);\n    }).catch(err => {\n      //TODO error handling\n    });\n  }\n\n  const fetchData = () => {\n    query();\n  }\n\n  const handleSearch = (e) => {\n    if (e) e.preventDefault();\n    let input = document.getElementById('search').value;\n    document.getElementById('search').blur();\n\n    history.push(\"/browse/s/\" + input);\n  }\n\n  const getLink = (identifier) => {\n    if (isSearch != \"\") {\n      return \"/read/\" + identifier + \"/p/s/\" + parentIdentifier;\n    } else {\n      return \"/read/\" + identifier + \"/p/b/\" + parentIdentifier;\n    }\n  }\n\n  const getHeader = () => {\n    if (isSearch) {\n      return \"Searching for: \" + parentIdentifier;\n    } else {\n      switch (parentIdentifier) {\n        case \"magazine_rack\":\n          return \"Browsing the Magazine Rack\";\n        case null:\n          return <br />\n        case undefined:\n          return <br />\n        default:\n          return \"Browsing '\" + parentIdentifier + \"'\";\n      }\n    }\n  }\n\n\n  return (\n    <div className=\"page\">\n      <div style={{ marginTop: '4px', marginRight: '14px' }}>\n        <form action=\"\" onSubmit={\n          (event) => handleSearch(event)}>\n          <StatefulInput\n            value={isSearch ? parentIdentifier : \"\"}\n            id=\"search\"\n            type=\"search\"\n            placeholder=\"Search the Internet Archive\"\n            size={SIZE.compact}\n            autoComplete=\"false\"\n            overrides={{\n              StartEnhancer: {\n                style: {\n                  marginLeft: '0px',\n                  marginRight: '0px',\n                  paddingLeft: '0px',\n                  paddingRight: '0px',\n                  color: '#888888'\n                }\n              }\n            }}\n            startEnhancer={<SearchIcon size=\"22px\" />}\n          />\n        </form>\n\n      </div>\n\n      <div style={{ fontSize: '85%', paddingTop: '14px', color: '#cbcbcb' }}>\n        {getHeader()}\n      </div>\n\n      <ItemDrawer\n        ref={drawer}\n        buttonCount={2}\n        buttonLabel={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return currentExisting ? 'Continue reading' : 'Start reading';\n            case 1:\n              return (!currentArchived) ? 'Read later' : 'Unarchive';\n          }\n        }}\n        buttonAction={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              startReading(identifier, title);\n              break;\n            case 1:\n              readLater(identifier, title);\n              break;\n          }\n        }}\n        buttonDisabled={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return false;\n            default:\n              return (currentExisting && !currentArchived);\n            // return true;\n          }\n        }}\n      />\n\n      {(browserItems.length > 0 && !initial)\n        ? <div>\n          <ul>\n            {browserItems.map(itemMetadataToListItem)}\n          </ul>\n          <InfiniteScroll\n            dataLength={browserItems.length}\n            next={fetchData}\n            hasMore={hasMore}\n            loader={<Centered><StyledSpinnerNext /></Centered>} />\n        </div>\n        : <div>\n          {initial\n            ? <Centered><StyledSpinnerNext /></Centered>\n            : <Centered>No results found.</Centered>\n          }\n        </div>\n      }\n\n    </div>\n  );\n}\n\nexport default withRouter(Browser);","import React, { useState, useEffect } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport ItemMetadataListItem from '../Components/ItemMetadataListItem'\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport { Centered } from '../Components/Centered';\nimport db from '../Components/Db';\nimport ItemDrawer from '../Components/ItemDrawer';\n\nconst Collection = (props) => {\n  const history = useHistory();\n  const drawer = React.useRef(null);\n\n  const [browserItems, setBrowserItems] = useState([]);\n  const [initial, setInitial] = useState(true);\n\n  useEffect(() => {\n    reloadDb();\n  }, []);\n\n  const reloadDb = () => {\n    db.collection\n      .filter(function (item) {\n        return item.archived === false;\n      })\n      .toArray()\n      .then((items) => {\n        setBrowserItems(items)\n        setInitial(false)\n      });\n  }\n\n  const handleItemClick = async (event, identifier) => {\n    let item = (browserItems.find(obj => {\n      return obj.id === identifier\n    }));\n    // TODO error handling\n    history.push(\"/read/\" + identifier + \"/p/c\");\n  }\n\n  const handleEditClick = (event, item, title) => {\n    event.stopPropagation();\n    drawer.current.showDrawer(item, title);\n  }\n\n  const archiveItem = (identifier) => {\n    db.collection.update({ id: identifier }, { archived: true })\n    .then((result) => {\n      drawer.current.hideDrawer();\n      reloadDb();\n    });\n  }\n\n  const itemMetadataToListItem = (item) => {\n    return <ItemMetadataListItem\n      key={item.id}\n      title={item.title}\n      identifier={item.id}\n      mediatype=\"text\"\n      onEditClick={(event) => handleEditClick(event, item.id, item.title)}\n      onSelectItem={(event) => handleItemClick(event, item.id)} />;\n  }\n\n  return (\n    <div className=\"page\">\n\n      <ItemDrawer\n        ref={drawer}\n        buttonCount={1}\n        buttonLabel={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return 'Archive (hide item)'\n          }\n        }}\n        buttonAction={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              archiveItem(identifier);\n              break;\n          }\n        }}\n      />\n\n      <div style={{ marginTop: '4px', marginRight: '14px', fontSize: '85%', color: '#cbcbcb' }}>\n        Your Collection\n        </div>\n\n      {(browserItems.length > 0 && !initial)\n        ? <div id=\"go\">\n          <ul>\n            {browserItems.map(itemMetadataToListItem)}\n          </ul>\n          <InfiniteScroll\n            dataLength={browserItems.length}\n            loader={<Centered><StyledSpinnerNext /></Centered>}>\n          </InfiniteScroll>\n        </div>\n        : <div id=\"go\">\n          {initial\n            ? <Centered><StyledSpinnerNext /></Centered>\n            : <Centered>Your Collection is empty.</Centered>\n          }\n        </div>\n      }\n    </div>\n  )\n}\n\nexport default Collection;","import React, { useState, useEffect } from 'react';\nimport { withRouter, useHistory } from 'react-router-dom'\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport { PhotoSwipe } from 'react-pswp';\nimport 'react-pswp/dist/index.css';\nimport InternetArchive from '../Components/InternetArchive';\nimport { Centered } from '../Components/Centered';\nimport db from '../Components/Db';\n\nfunction Reader(props) {\n  const [browserItems, setBrowserItems] = useState([]);\n  const [index, setIndex] = useState(0);\n  const [open, setOpen] = useState(false);\n  const history = useHistory();\n  const [currentItem, setCurrentItem] = useState(null);\n\n  let id = props.match.params.id;\n  let prevAction = props.match.params.prevAction;\n  let prevId = props.match.params.prevId;\n\n  useEffect(() => {\n    InternetArchive.BookManifestAPI.get({ identifier: id }).then(bookMetadata => {\n      db.collection.get({ id: id })\n        .then((item) => {\n          if (item != undefined) {\n            setCurrentItem(item);\n            setIndex(item.page);\n          } else {\n            item = {\n              id: bookMetadata.itemId,\n              title: bookMetadata.title,\n              page: 0,\n              read: false,\n              archived: false\n            }\n            setCurrentItem(item);\n            setIndex(0);\n            db.collection.put(currentItem, id);\n          }\n          let pages = getImageItems(bookMetadata);\n          setBrowserItems(pages);\n          setOpen(true);\n        });\n    });\n  }, []);\n\n  const getImageItems = (bookMetadata) => {\n    let items = [];\n    let pageCount = bookMetadata.numPages;\n    let image_options = '_h1000';\n\n    for (var i = 0; i < pageCount; i++) {\n      let numString = i.toString().padStart(4, '0');\n      items.push({\n        src: `https://archive.org/download/${id}/page/leaf${i}${image_options}.jpg`,\n        // w: bookMetadata.pageWidths[i],\n        // h: bookMetadata.pageHeights[i],\n        w: window.innerWidth,\n        h: window.innerHeight,\n      })\n    }\n    return items;\n  }\n\n  const updateIndex = async (pagenum) => {\n    currentItem.page = pagenum;\n    db.collection.put(currentItem, id);\n  }\n\n  let options = {\n    index: 0,\n    showAnimationDuration: 0,\n    hideAnimationDuration: 0,\n    fullscreenEl: false,\n    allowPanToNext: true,\n    bgOpacity: 1,\n    pinchToClose: false,\n    closeOnScroll: false,\n    closeOnVerticalDrag: false,\n    maxSpreadZoom: 3,\n    barsSize: { top: 16, bottom: 'auto' },\n    timeToIdle: 3000,\n    timeToIdleOutside: 1000,\n    captionEl: false,\n    arrowEl: true,\n    zoomEl: false,\n    tapToClose: false,\n    tapToToggleControls: true,\n    clickToCloseNonZoomable: false,\n    getDoubleTapZoom: function (isMouseClick, item) {\n      return 3;\n    },\n    history: false,\n    preload: [1, 2],\n    modal: false,\n  };\n\n  const setOpened = (state) => {\n    if (!state) {\n      if (prevAction != undefined && prevId != undefined) {\n        if (prevAction == \"s\") {\n          history.push(\"/browse/s/\" + prevId);\n        } else {\n          history.push(\"/browse/\" + prevId)\n        }\n      } else if (prevAction == \"c\") {\n        history.push(\"/collection\");\n      } else {\n        history.push(\"/browse\");\n      }\n    }\n  }\n\n  return (\n    <div>\n      {!open\n        ?\n        (<div>\n          <div className=\"page\"><br /><Centered><StyledSpinnerNext /></Centered></div>\n        </div>)\n        :\n        (<PhotoSwipe\n          container={browserItems}\n          onIndexChange={updateIndex}\n          onOpenChange={setOpened.bind(this)}\n          index={index}\n          open={open}\n          options={options}\n          theme={{\n            foreground: '#ffffff',\n            background: '#000000',\n          }}\n        />)\n\n      }\n    </div>\n  )\n}\n\nexport default withRouter(Reader);\n","import preval from 'preval.macro';\nimport {\n    Modal,\n    ModalHeader,\n    ModalBody,\n    ModalFooter,\n    ModalButton,\n    ROLE,\n    SIZE\n} from 'baseui/modal';\n\nimport { Link } from 'react-router-dom';\n\nconst About = (props) => {\n    const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`\n\n    return (\n        <Modal\n            isOpen={props.isOpen}\n            onClose={() => props.onClose()}\n            closeable\n            animate\n            autoFocus\n            size={SIZE.default}\n            role={ROLE.dialog}>\n            <ModalHeader>LoboReader<br />for Internet Archive</ModalHeader>\n            <ModalBody>\n                Build date: {dateTimeStamp}<br /><br />\n                LoboReader is an unofficial reader for the Internet Archive \"Magazine Rack\".<br/><br/>\n                For changelog, docs & licensing please visit project page on GitHub.\n            </ModalBody>\n            <ModalFooter>\n            <Link to={{ pathname: \"https://github.com/gitGalu\" }} target=\"_blank\"><ModalButton kind=\"primiary\">Visit GitHub</ModalButton></Link>\n            </ModalFooter>\n        </Modal>\n    )\n}\n\nexport default About;\n","import {\n    Modal,\n    ModalHeader,\n    ModalBody,\n    ROLE,\n    SIZE\n} from 'baseui/modal';\n\nimport {\n    StyledBody,\n  } from \"baseui/card\";\n\nconst StandaloneWarning = (props) => {\n    return (\n        <Modal\n            isOpen={true}\n            closeable={false}\n            animate\n            size={SIZE.default}\n            role={ROLE.alertdialog}>\n            <ModalHeader>LoboReader<br />for Internet Archive</ModalHeader>\n            <ModalBody className=\"doubleSpace\">\n               <StyledBody>\n               <p>LoboReader is an unofficial reader for the Internet Archive \"Magazine Rack\".</p>\n               <p></p>\n               <p>You have to add it to your Home screen and launch it from the app icon:</p>\n               <ul>\n               <li>When using Safari (iOS and iPadOS), tap the Share button and select \"Add to Home Screen\".</li>\n               <li>When using Chrome (Android), tap the menu overflow button (three dots) and select \"Add to Home screen\".</li>\n               </ul>\n               </StyledBody>\n            </ModalBody>\n        </Modal>\n    )\n}\n\nexport default StandaloneWarning;\n","import React from 'react';\nimport { Helmet } from 'react-helmet';\nimport { Route, Switch, withRouter, Link, NavLink } from 'react-router-dom';\nimport { HeaderNavigation, ALIGN, StyledNavigationList, StyledNavigationItem } from 'baseui/header-navigation';\nimport { Button, KIND } from 'baseui/button';\nimport { StatefulButtonGroup, MODE } from 'baseui/button-group';\nimport { SnackbarProvider, PLACEMENT } from 'baseui/snackbar';\nimport Browser from './Routes/Browser';\nimport Collection from './Routes/Collection';\nimport Reader from './Routes/Reader';\nimport About from './Components/About';\nimport StandaloneWarning from './Components/StandaloneWarning';\nimport './App.css';\n\nconst App = (props) => {\n    const [isOpen, setOpen] = React.useState(false);\n\n    const { isStandalone } = (window.matchMedia('(display-mode: standalone)').matches);\n\n    return (\n        !isStandalone\n            ?\n            <StandaloneWarning />\n            :\n            <SnackbarProvider placement={PLACEMENT.top}>\n                <Helmet>\n                    <meta charSet=\"utf-8\" />\n                    <title>LoboReader</title>\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"></meta>\n                    <meta name=\"robots\" content=\"noindex\" />\n                </Helmet>\n                <About isOpen={isOpen} onClose={() => setOpen(false)}></About>\n                <div className=\"anchored-top\">\n                    <HeaderNavigation\n                        overrides={{\n                            Root: {\n                                style: {\n                                    height: '48px',\n                                    width: '100%',\n                                }\n                            }\n                        }}>\n                        <StyledNavigationList\n                            $align={ALIGN.left}>\n                            <StyledNavigationItem className=\"header\">\n                                <div>LoboReader</div></StyledNavigationItem>\n                        </StyledNavigationList>\n                        <StyledNavigationList $align={ALIGN.center} />\n                        <StyledNavigationList $align={ALIGN.right}>\n                            <StyledNavigationItem>\n                                <Link to=\"#\">\n                                    <div\n                                        className=\"header\"\n                                        style={{\n                                            float: 'right',\n                                            marginRight: '16px',\n                                            marginTop: '-4px',\n                                            fontSize: '75%'\n                                        }}\n                                        onClick={() => setOpen(s => !s)}>\n                                        About\n                                </div>\n                                </Link>\n                            </StyledNavigationItem>\n                        </StyledNavigationList>\n                    </HeaderNavigation>\n\n                    <div className=\"menuBar\">\n                        <StatefulButtonGroup\n                            mode={MODE.radio}\n                            initialState={{ selected: 0 }}>\n                            <NavLink\n                                to=\"/browse\"\n                                isActive={(match, location) => {\n                                    if (match || '/' === location.pathname) {\n                                        return true;\n                                    }\n                                }}\n                                activeClassName=\"menuActive\">\n                                <Button kind={KIND.tertiary}>Browse</Button>\n                            </NavLink>\n                            <NavLink\n                                to=\"/collection\"\n                                isActive={(match, location) => {\n                                    return match;\n                                }}\n                                activeClassName=\"menuActive\">\n                                <Button kind={KIND.tertiary}>Collection</Button>\n                            </NavLink>\n                        </StatefulButtonGroup>\n                    </div>\n                </div>\n\n                <div className=\"container\">\n                    <Switch>\n                        <Route exact path=\"/\" component={Browser} />\n                        <Route exact path=\"/browse/s/:searchQuery\" component={Browser} />\n                        <Route exact path=\"/browse/:id\" component={Browser} />\n                        <Route path=\"/browse\" component={Browser} />\n                        <Route exact path=\"/collection\" component={Collection} />\n                        <Route exact path=\"/read/:id\" component={Reader} />\n                        <Route exact path=\"/read/:id/p/:prevAction\" component={Reader} />\n                        <Route exact path=\"/read/:id/p/:prevAction/:prevId\" component={Reader} />\n                        <Route default component={Browser} />\n                    </Switch>\n                </div>\n            </SnackbarProvider>\n    );\n}\n\nexport default withRouter(App)","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Client as Styletron } from 'styletron-engine-atomic';\nimport { Provider as StyletronProvider } from 'styletron-react';\nimport { LightTheme, BaseProvider } from 'baseui';\nimport App from './App/App';\n\nReactDOM.render(\n  <StyletronProvider value={new Styletron()}>\n    <BaseProvider theme={LightTheme}>\n      <BrowserRouter>\n        <App />\n      </BrowserRouter>\n    </BaseProvider>\n  </StyletronProvider>\n  ,\n  document.getElementById('root')\n);"],"sourceRoot":""}