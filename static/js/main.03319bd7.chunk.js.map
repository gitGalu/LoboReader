{"version":3,"sources":["App/Components/InternetArchive.js","App/Components/Db.js","App/Components/Centered.js","App/Components/ItemMetadataListItem.js","App/Components/ItemDrawer.js","App/Routes/Browser.js","App/Routes/Collection.js","App/Routes/Reader.js","App/Components/About.js","App/Components/StandaloneWarning.js","App/App.js","index.js"],"names":["paramify","obj","URLSearchParams","toString","fetchJson","url","options","a","fetch","res","json","BookMetaAPI","this","API_BASE","identifier","Error","get","BookManifestAPI","ExpBookAPI","InternetArchive","SearchAPI","q","page","fields","buildQueryFromObject","reqParams","fl","output","encodedParams","qObject","Object","keys","map","key","Array","isArray","v","join","db","Dexie","version","stores","collection","acknowledgements","Centered","styled","display","justifyContent","alignItems","height","marginTop","marginBottom","marginRight","withRouter","props","renderRow","gridView","renderGridElement","renderListElement","className","effect","src","match","params","searchQuery","id","parentIdentifier","mediatype","title","endEnhancer","mediaType","onEditClick","onClick","event","kind","KIND","secondary","size","SIZE","mini","renderEndEnhancer","editable","overrides","Content","style","borderRadius","verticalAlign","objectPosition","width","minWidth","minHeight","objectFit","to","process","onSelectItem","renderItem","ItemDrawer","forwardRef","ref","useState","drawerOpen","setDrawerOpen","setIdentifier","undefined","setTitle","useImperativeHandle","showDrawer","hideDrawer","isOpen","autoFocus","onClose","anchor","ANCHOR","bottom","auto","textAlign","maxHeight","buttons","i","push","disabled","buttonDisabled","buttonAction","buttonLabel","buttonCount","renderButtons","browserItems","setBrowserItems","setPage","initial","setInitial","isSearch","setIsSearch","setParentIdentifier","currentExisting","setCurrentExisting","currentArchived","setCurrentArchived","totalItems","setTotalItems","history","useHistory","drawer","React","useRef","enqueue","useSnackbar","useEffect","location","pathname","reloadQuery","query","handleItemClick","then","dbItem","archived","current","addToCollection","add","read","showNotification","put","message","startEnhancer","fetchData","ia","rows","sort","results","dox","response","docs","b","concat","console","log","length","numFound","catch","err","getLink","DataItem","data","fetchMoreItems","memoize","startIndex","stopIndex","maybeLoadMore","useInfiniteLoader","action","onSubmit","e","preventDefault","input","document","getElementById","value","blur","handleSearch","type","placeholder","compact","autoComplete","StartEnhancer","marginLeft","paddingLeft","paddingRight","color","fontSize","paddingTop","float","getHeader","index","startReading","readLater","items","columnGutter","columnWidth","columnCount","overscanBy","render","onRender","Collection","reloadDb","filter","item","toArray","find","stopPropagation","handleEditClick","update","result","alert","window","archiveItem","setIndex","open","setOpen","currentItem","setCurrentItem","prevAction","prevId","bookMetadata","itemId","pages","getImageItems","pageCount","numPages","minWidthToScale","pageWidths","w","h","pageHeights","updateIndex","pagenum","container","onIndexChange","onOpenChange","state","bind","showAnimationDuration","hideAnimationDuration","fullscreenEl","allowPanToNext","bgOpacity","pinchToClose","closeOnScroll","closeOnVerticalDrag","maxSpreadZoom","barsSize","top","timeToIdle","timeToIdleOutside","captionEl","arrowEl","zoomEl","tapToClose","tapToToggleControls","clickToCloseNonZoomable","getDoubleTapZoom","isMouseClick","initialZoomLevel","preload","modal","theme","foreground","background","About","closeable","animate","default","role","ROLE","dialog","target","StandaloneWarning","alertdialog","matchMedia","matches","placement","PLACEMENT","Helmet","charSet","name","content","Root","$align","ALIGN","center","right","s","mode","MODE","radio","initialState","selected","isActive","activeClassName","tertiary","exact","path","component","Browser","Reader","ReactDOM","Styletron","LightTheme"],"mappings":"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","file":"static/js/main.03319bd7.chunk.js","sourcesContent":["import fetch from \"node-fetch\";\n\nconst paramify = (obj) => new URLSearchParams(obj).toString();\n\nconst fetchJson = async function (url, options) {\n  const res = await fetch(url, options);\n  return await res.json();\n};\n\nclass BookMetaAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}`;\n    return fetchJson(url);\n  }\n  async metadata(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass BookManifestAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}/ia_manifest`;\n    return fetchJson(url);\n  }\n  async metadata(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass ExpBookAPI {\n  constructor() {\n    this.API_BASE = \"https://api.archivelab.org/v1/books/\";\n  }\n  async get({ identifier = null }) {\n    if (!identifier) {\n      throw new Error(\"Missing required arg 'identifier'\");\n    }\n    const url = `${this.API_BASE}/${identifier}/pages`;\n    return fetchJson(url);\n  }\n  async pages(identifier) {\n    return await this.get({ identifier });\n  }\n}\n\nclass SearchAPI {\n  constructor() {\n    this.API_BASE = \"https://archive.org/advancedsearch.php\";\n  }\n  async get({ q = null, page = 1, fields = [\"identifier\"], ...options } = {}) {\n    if (!q) {\n      throw new Error(\"Missing required arg 'q'\");\n    }\n    if (typeof q == \"object\") {\n      q = this.buildQueryFromObject(q);\n    }\n    const reqParams = {\n      q,\n      page,\n      fl: fields,\n      ...options,\n      output: \"json\",\n    };\n    const encodedParams = paramify(reqParams);\n    const url = `${this.API_BASE}?${encodedParams}`;\n    return fetchJson(url);\n  }\n  async search(q) {\n    return await this.get({ q });\n  }\n  buildQueryFromObject(qObject) {\n    // Map dictionary to a key=val search query\n    return Object.keys(qObject)\n      .map((key) => {\n        if (Array.isArray(qObject[key])) {\n          return `${key}:( ${qObject[key].map((v) => `\"${v}\"`).join(\" OR \")} )`;\n        } else {\n          return `${key}:\"${qObject[key]}\"`;\n        }\n      })\n      .join(\" AND \");\n  }\n}\n\nconst InternetArchive = {\n  SearchAPI: new SearchAPI(),\n  ExpBookAPI: new ExpBookAPI(),\n  BookMetaAPI: new BookMetaAPI(),\n  BookManifestAPI: new BookManifestAPI()\n};\n\nexport default InternetArchive;","import Dexie from 'dexie';\n\nconst DATABASE_NAME = 'LoboReader';\nconst DATABASE_VERSION = 4;\n\nconst db = new Dexie(DATABASE_NAME);\n\ndb.version(DATABASE_VERSION).stores({\n    collection: 'id',\n    acknowledgements: 'id'\n});\n\nexport default db;","import { styled } from 'baseui';\n\nexport const Centered = styled('div', {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100%',\n    marginTop: '32px',\n    marginBottom: '24px',\n    marginRight: '24px',\n    height: '100%',\n  });\n\n  ","import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { ListItem } from 'baseui/list';\nimport { LazyLoadComponent, LazyLoadImage } from 'react-lazy-load-image-component'\nimport 'react-lazy-load-image-component/src/effects/opacity.css';\nimport { ChevronRight } from \"baseui/icon\";\nimport { Button, KIND, SIZE } from 'baseui/button';\n\nconst ItemMetadataListItem = (props) => {\n\n  const renderItem = () => {\n    switch (props.mediatype) {\n      case 'collection':\n        return (\n          <Link to={`${process.env.PUBLIC_URL}/browse/` + props.identifier}>\n            <div className=\"rowItem\">\n              {renderRow()}\n            </div>\n          </Link>\n        );\n      default:\n        return (\n          <div className=\"rowItem\" onClick={(event) => props.onSelectItem(event, props.identifier, props.title)}>\n            { renderRow()}\n          </div>\n        );\n    }\n  }\n\n  const renderEndEnhancer = (mediaType) => {\n    switch (mediaType) {\n      case 'collection':\n        return (<ChevronRight />);\n      default:\n        if (props.onEditClick) {\n          return (<Button onClick={(event) => props.onEditClick(event, props.identifier, props.title)}\n            kind={KIND.secondary}\n            size={SIZE.mini}>\n            Edit\n          </Button>);\n        }\n    }\n    return (<div />);\n  }\n\n  const renderRow = () => {\n    return (props.gridView ? renderGridElement() : renderListElement());\n  }\n\n  const renderGridElement = () => {\n    return (\n      <div>\n        <LazyLoadComponent>\n          <div >\n            <img\n              className={\"gridImg\"}\n              effect=\"opacity\"\n              key={props.match.params.searchQuery + props.match.params.id + props.match.params.parentIdentifier}\n              src={\"https://archive.org/services/img/\" + props.identifier}\n            />\n            {(props.mediatype === \"collection\") ? <div /> : <div />}\n            <div className={\"cardoverlay\"} />\n          </div>\n        </LazyLoadComponent>\n\n        {(props.mediatype === \"collection\") ?\n          <div className=\"collectionLabel\">{props.title}</div>\n          : <div />}\n\n      </div>\n    );\n  }\n\n  const renderListElement = () => {\n    return (\n      <ListItem\n        key=\"{props.identifier}\"\n        endEnhancer={() => renderEndEnhancer(props.mediatype, props.editable)}\n        overrides={{\n          Content: {\n            style: {\n              'padding-left': '0px !important',\n              'margin-left': '0px !important',\n              'padding-right': '0px !important',\n              'width': '100%'\n            }\n          }\n        }}>\n\n        <LazyLoadImage\n          className=\"listImg\"\n          style={{\n            borderRadius: '5px',\n            verticalAlign: 'middle',\n            objectPosition: '0% 0%',\n            width: '64px',\n            height: '36px',\n            minWidth: '64px',\n            minHeight: '36px',\n            objectFit: 'cover',\n          }}\n          effect=\"opacity\"\n          key={\"https://archive.org/services/img/\" + props.identifier}\n          src={\"https://archive.org/services/img/\" + props.identifier}\n          width={'64px'}\n        />\n\n        <div className=\"description\">\n          {props.title}\n        </div>\n      </ListItem>\n    )\n  }\n\n  return (\n    renderItem()\n  )\n}\n\nexport default withRouter(ItemMetadataListItem);","import React, { useState, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport 'react-lazy-load-image-component/src/effects/opacity.css';\nimport { Button, KIND, SIZE } from 'baseui/button';\nimport { H6 } from 'baseui/typography';\nimport { Drawer, ANCHOR } from \"baseui/drawer\";\n\nconst ItemDrawer = forwardRef((props, ref) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [identifier, setIdentifier] = useState(\"\");\n    const [title, setTitle] = useState(undefined);\n\n    useImperativeHandle(ref, () => {\n        return {\n            showDrawer: showDrawer,\n            hideDrawer: hideDrawer\n        }\n    });\n\n    const showDrawer = (identifier, title) => {\n        setIdentifier(identifier);\n        setTitle(title);\n        setDrawerOpen(true);\n    };\n\n    const hideDrawer = () => {\n        setDrawerOpen(false);\n    };\n\n    const renderButtons = () => {\n        let buttons = [];\n        for (let i = 0; i < props.buttonCount; i++) {\n            buttons.push(\n                <div>\n                    <Button\n                        disabled={(props.buttonDisabled == undefined) ? false : props.buttonDisabled(i, identifier, title)}\n                        onClick={() => props.buttonAction(i, identifier, title)}>\n                        {props.buttonLabel(i, identifier, title)}\n                    </Button><br /><br />\n                </div>\n            );\n        }\n        return buttons;\n    }\n\n    const getTitle = () => {\n        return (title != undefined ? title : '');\n    }\n\n    const getImgUrl = () => {\n        return (identifier != undefined ? 'https://archive.org/services/img/' + identifier : '');\n    }\n\n    return (\n        <Drawer\n            isOpen={drawerOpen}\n            autoFocus\n            onClose={() => setDrawerOpen(false)}\n            anchor={ANCHOR.bottom}\n            size={SIZE.auto}>\n\n            <div style={{ textAlign: 'center' }}>\n                <H6>{getTitle()}</H6>\n                <br />\n                <img\n                    src={getImgUrl()}\n                    style={{\n                        maxHeight: '175px',\n                        borderRadius: '5px',\n                        objectFit: 'cover'\n                    }}\n                />\n                <br /><br />\n                {renderButtons()}\n            </div>\n        </Drawer>\n    )\n});\n\nexport default ItemDrawer;","import React, { useState, useEffect } from 'react';\nimport { withRouter, useHistory } from \"react-router-dom\";\nimport { Search as SearchIcon } from 'baseui/icon';\nimport Check from 'baseui/icon/check';\nimport { SIZE } from \"baseui/input\";\nimport { StatefulInput } from 'baseui/input';\nimport { useSnackbar } from 'baseui/snackbar';\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport ia from \"../Components/InternetArchive\";\nimport db from '../Components/Db';\nimport { Centered } from '../Components/Centered';\nimport ItemMetadataListItem from '../Components/ItemMetadataListItem'\nimport ItemDrawer from '../Components/ItemDrawer';\nimport { Masonry, useInfiniteLoader } from 'masonic';\nimport memoize from 'memoize-one';\n\n\nconst Browser = (props) => {\n  const [browserItems, setBrowserItems] = useState([]);\n  const [page, setPage] = useState(1);\n  const [initial, setInitial] = useState(true);\n  const [isSearch, setIsSearch] = useState(false);\n  const [parentIdentifier, setParentIdentifier] = useState(undefined);\n  const [currentExisting, setCurrentExisting] = useState(false);\n  const [currentArchived, setCurrentArchived] = useState(false);\n  const [gridView, setGridView] = useState(true);\n  const [totalItems, setTotalItems] = useState(0);\n\n  const history = useHistory();\n  const drawer = React.useRef(null);\n  const { enqueue } = useSnackbar();\n\n  useEffect(() => {\n    setBrowserItems([]);\n    setPage(1);\n    setInitial(true);\n\n    if (props.match.params.searchQuery !== undefined) {\n      setIsSearch(true);\n      setParentIdentifier(props.match.params.searchQuery);\n    } else {\n      setIsSearch(false);\n      (props.match.params.id && props.match.params.id !== \"s\") ? setParentIdentifier(props.match.params.id) : setParentIdentifier(\"magazine_rack\");\n    }\n  }, [props.location.pathname]);\n\n  useEffect(() => {\n    setBrowserItems([]);\n    reloadQuery();\n  }, [parentIdentifier]);\n\n  const reloadQuery = () => {\n    setPage(1);\n    setInitial(true);\n    query();\n  }\n\n  const handleItemClick = async (event, identifier, title) => {\n    db.collection.get({ id: identifier })\n      .then((dbItem) => {\n        setCurrentExisting(dbItem !== undefined);\n        setCurrentArchived((dbItem !== undefined) ? dbItem.archived : false);\n        drawer.current.showDrawer(identifier, title);\n      });\n  }\n\n  const startReading = (identifier, title) => {\n    addToCollection(identifier, title);\n    history.push(getLink(identifier, title));\n  }\n\n  const readLater = (identifier, title) => {\n    addToCollection(identifier, title);\n    drawer.current.hideDrawer();\n  }\n\n  const addToCollection = async (identifier, title) => {\n    const dbItem = await db.collection.get({ id: identifier });\n    if (dbItem === undefined) {\n      db.collection.add({\n        id: identifier,\n        title: title,\n        page: 0,\n        read: false,\n        archived: false\n      }, identifier)\n        .then(function (id) {\n          showNotification();\n        });\n    } else {\n      dbItem.archived = false;\n      db.collection.put(dbItem);\n    }\n  }\n\n  const showNotification = () => {\n    enqueue({\n      message: 'Item was added.',\n      startEnhancer: ({ size }) => <Check size={size} />\n    })\n  }\n\n  const query = () => {\n    if (parentIdentifier == undefined) {\n      return;\n    }\n    fetchData();\n  }\n\n  const fetchData = () => {\n    ia.SearchAPI.get({\n      q: isSearch ? '(\"' + parentIdentifier + '\") (collection:(\"magazine_rack\") AND mediatype:(collection OR texts))' : 'collection:(\"' + parentIdentifier + '\" AND mediatype:(collection OR texts))',\n      fields: ['identifier', 'title', 'mediatype', 'type', 'metadata'],\n      rows: 50,\n      page: page,\n      sort: ['mediatype asc', 'identifier asc']\n    }).then(results => {\n      let dox = results.response.docs;\n      dox.sort((a, b) => (a.title > b.title) ? 1 : ((b.title > a.title) ? -1 : 0))\n      dox.sort((a, b) => (a.mediaType > b.mediaType) ? 1 : ((b.mediaType > a.mediaType) ? -1 : 0))\n      dox = browserItems.concat(dox);\n      console.log(\"browserItems: \" + browserItems.length + \", dox:\" + dox.length);\n      setBrowserItems(dox);\n      setTotalItems(results.response.numFound);\n      setInitial(false);\n      setPage(page + 1);\n    }).catch(err => {\n      //TODO error handling\n    });\n  }\n\n  const handleSearch = (e) => {\n    if (e) e.preventDefault();\n    let input = document.getElementById('search').value;\n    document.getElementById('search').blur();\n    history.push(`${process.env.PUBLIC_URL}/browse/s/${input}`);\n  }\n\n  const getLink = (identifier) => {\n    if (isSearch != \"\") {\n      return `${process.env.PUBLIC_URL}/read/${identifier}/p/s/${parentIdentifier}`;\n    } else {\n      return `${process.env.PUBLIC_URL}/read/${identifier}/p/b/${parentIdentifier}`;\n    }\n  }\n\n  const getHeader = () => {\n    if (isSearch) {\n      return \"Searching for: \" + parentIdentifier;\n    } else {\n      switch (parentIdentifier) {\n        case \"magazine_rack\":\n          return \"Browsing the Magazine Rack\";\n        case null:\n          return <br />\n        case undefined:\n          return <br />\n        default:\n          return \"Browsing '\" + parentIdentifier + \"'\";\n      }\n    }\n  }\n\n  const DataItem = ({ data: { identifier, title, mediatype } }) => (\n    <ItemMetadataListItem\n      key={identifier}\n      title={title}\n      identifier={identifier}\n      mediatype={mediatype}\n      gridView={gridView}\n      onSelectItem={(event, identifier, title) => handleItemClick(event, identifier, title)}\n    />\n  );\n\n  const fetchMoreItems = memoize((startIndex, stopIndex) => {\n    if (stopIndex > (totalItems - 1)) {\n      stopIndex = totalItems - 1;\n      if (startIndex > (totalItems - 1)) {\n        return;\n      }\n    }\n    fetchData();\n  });\n\n  const maybeLoadMore = useInfiniteLoader(fetchMoreItems);\n\n  const renderData = () => {\n    return (\n      <div>\n        <Masonry\n          items={browserItems}\n          columnGutter={gridView ? 16 : 0}\n          columnWidth={80}\n          columnCount={gridView ? undefined : 1}\n          overscanBy={3}\n          render={DataItem}\n          onRender={maybeLoadMore}\n        />\n      </div>\n    )\n  }\n\n  const renderEmpty = () => {\n    return (\n      <div>\n        {initial\n          ? <Centered><StyledSpinnerNext /></Centered>\n          : <Centered>No results found.</Centered>\n        }\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page\">\n      <div style={{ marginTop: '4px', marginRight: '14px' }}>\n        <form action=\"\" onSubmit={\n          (event) => handleSearch(event)}>\n          <StatefulInput\n            value={isSearch ? parentIdentifier : \"\"}\n            id=\"search\"\n            type=\"search\"\n            placeholder=\"Search the Internet Archive\"\n            size={SIZE.compact}\n            autoComplete=\"false\"\n            overrides={{\n              StartEnhancer: {\n                style: {\n                  marginLeft: '0px',\n                  marginRight: '0px',\n                  paddingLeft: '0px',\n                  paddingRight: '0px',\n                  color: '#888888'\n                }\n              }\n            }}\n            startEnhancer={<SearchIcon size=\"22px\" />}\n          />\n        </form>\n\n      </div>\n\n      <div style={{ fontSize: '85%', paddingTop: '14px', color: '#cbcbcb' }}>\n        <span style={{ float: 'left' }}>\n          {getHeader()}\n        </span>\n      </div>\n\n      <ItemDrawer\n        ref={drawer}\n        buttonCount={2}\n        buttonLabel={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return currentExisting ? 'Continue reading' : 'Start reading';\n            case 1:\n              return (!currentArchived) ? 'Read later' : 'Unarchive';\n          }\n        }}\n        buttonAction={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              startReading(identifier, title);\n              break;\n            case 1:\n              readLater(identifier, title);\n              break;\n          }\n        }}\n        buttonDisabled={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return false;\n            default:\n              return (currentExisting && !currentArchived);\n          }\n        }}\n      />\n\n      <div  style={{ paddingRight: '16px', paddingTop: '32px' }}>\n        {(browserItems.length > 0 && !initial)\n          ?\n          renderData()\n          :\n          renderEmpty()\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(Browser);","import React, { useState, useEffect } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport ItemMetadataListItem from '../Components/ItemMetadataListItem'\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport { Centered } from '../Components/Centered';\nimport db from '../Components/Db';\nimport ItemDrawer from '../Components/ItemDrawer';\nimport { Masonry } from 'masonic';\n\nconst Collection = (props) => {\n  const history = useHistory();\n  const drawer = React.useRef(null);\n\n  const [browserItems, setBrowserItems] = useState([]);\n  const [initial, setInitial] = useState(true);\n  const [gridView, setGridView] = useState(false);\n\n  useEffect(() => {\n    reloadDb();\n  }, []);\n\n  const reloadDb = () => {\n    db.collection\n      .filter(function (item) {\n        return item.archived === false;\n      })\n      .toArray()\n      .then((items) => {\n        setBrowserItems(items)\n        setInitial(false)\n      });\n  }\n\n  const handleItemClick = async (event, identifier) => {\n    let item = (browserItems.find(obj => {\n      return obj.id === identifier\n    }));\n    // TODO error handling\n    history.push(`${process.env.PUBLIC_URL}/read/${identifier}/p/c`);\n  }\n\n  const handleEditClick = (event, item, title) => {\n    event.stopPropagation();\n    drawer.current.showDrawer(item, title);\n  }\n\n  const archiveItem = (identifier) => {\n    db.collection.update({ id: identifier }, { archived: true })\n      .then((result) => {\n        drawer.current.hideDrawer();\n        alert(window.location);\n      });\n  }\n\n  const DataItem = ({ data: { id, title } }) => (\n    <ItemMetadataListItem\n      key={id}\n      title={title}\n      identifier={id}\n      mediatype=\"text\"\n      gridView={gridView}\n      onEditClick={(event) => handleEditClick(event, id, title)}\n      onSelectItem={(event) => handleItemClick(event, id)}\n    />\n  );\n\n  const renderData = () => {\n    return (\n      <div style={{ paddingRight: '16px' }}>\n        <Masonry\n          items={browserItems}\n          columnGutter={gridView ? 16 : 0}\n          columnWidth={80}\n          columnCount={gridView ? undefined : 1}\n          overscanBy={3}\n          render={DataItem}\n        />\n      </div>\n    )\n  }\n\n  const renderEmpty = () => {\n    return (\n    <div id=\"go\">\n      {initial\n        ? <Centered><StyledSpinnerNext /></Centered>\n        : <Centered>Your Collection is empty.</Centered>\n      }\n    </div>\n    );\n  }\n\n  return (\n    <div className=\"page\">\n      <ItemDrawer\n        ref={drawer}\n        buttonCount={1}\n        buttonLabel={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              return 'Archive (hide item)'\n          }\n        }}\n        buttonAction={(index, identifier, title) => {\n          switch (index) {\n            case 0:\n              archiveItem(identifier);\n              break;\n          }\n        }}\n      />\n\n      <div style={{ marginTop: '4px', marginRight: '14px', fontSize: '85%', color: '#cbcbcb' }}>\n        Your Collection\n        </div>\n\n      {(browserItems.length > 0 && !initial)\n        ?\n        renderData()\n        :\n        renderEmpty()\n      }\n    </div>\n  )\n}\n\nexport default Collection;","import React, { useState, useEffect } from 'react';\nimport { withRouter, useHistory } from 'react-router-dom'\nimport { StyledSpinnerNext } from 'baseui/spinner';\nimport { PhotoSwipe } from 'react-pswp';\nimport 'react-pswp/dist/index.css';\nimport InternetArchive from '../Components/InternetArchive';\nimport { Centered } from '../Components/Centered';\nimport db from '../Components/Db';\n\nfunction Reader(props) {\n  const [browserItems, setBrowserItems] = useState([]);\n  const [index, setIndex] = useState(0);\n  const [open, setOpen] = useState(false);\n  const history = useHistory();\n  const [currentItem, setCurrentItem] = useState(null);\n\n  let id = props.match.params.id;\n  let prevAction = props.match.params.prevAction;\n  let prevId = props.match.params.prevId;\n\n  useEffect(() => {\n    InternetArchive.BookManifestAPI.get({ identifier: id }).then(bookMetadata => {\n      db.collection.get({ id: id })\n        .then((item) => {\n          if (item != undefined) {\n            setCurrentItem(item);\n            setIndex(item.page);\n          } else {\n            item = {\n              id: bookMetadata.itemId,\n              title: bookMetadata.title,\n              page: 0,\n              read: false,\n              archived: false\n            }\n            setCurrentItem(item);\n            setIndex(0);\n            db.collection.put(currentItem, id);\n          }\n          let pages = getImageItems(bookMetadata);\n          setBrowserItems(pages);\n          setOpen(true);\n        });\n    });\n  }, []);\n\n  const getImageItems = (bookMetadata) => {\n    let items = [];\n    let pageCount = bookMetadata.numPages;\n    let image_options = '_h1000';\n\n    for (var i = 0; i < pageCount; i++) {\n      let minWidthToScale = (bookMetadata.pageWidths[i] > 3000);\n\n      items.push({\n        src: `https://archive.org/download/${id}/page/leaf${i}${image_options}.jpg`,\n        w: minWidthToScale ? (bookMetadata.pageWidths[i] / 2) : bookMetadata.pageWidths[i],\n        h: minWidthToScale ? (bookMetadata.pageHeights[i] / 2) : bookMetadata.pageHeights[i]\n      })\n    }\n    return items;\n  }\n\n  const updateIndex = async (pagenum) => {\n    currentItem.page = pagenum;\n    db.collection.put(currentItem, id);\n  }\n\n  let options = {\n    index: 0,\n    showAnimationDuration: 0,\n    hideAnimationDuration: 0,\n    fullscreenEl: false,\n    allowPanToNext: true,\n    bgOpacity: 1,\n    pinchToClose: false,\n    closeOnScroll: false,\n    closeOnVerticalDrag: false,\n    maxSpreadZoom: 3,\n    barsSize: { top: 16, bottom: 'auto' },\n    timeToIdle: 3000,\n    timeToIdleOutside: 1000,\n    captionEl: false,\n    arrowEl: true,\n    zoomEl: false,\n    tapToClose: false,\n    tapToToggleControls: true,\n    clickToCloseNonZoomable: false,\n    getDoubleTapZoom: function (isMouseClick, item) {\n      return item.initialZoomLevel * 3;\n    },\n    history: false,\n    preload: [1, 2],\n    modal: false,\n  };\n  \n  const setOpened = (state) => {\n    if (!state) {\n      if (prevAction != undefined && prevId != undefined) {\n        if (prevAction == \"s\") {\n          history.push(`${process.env.PUBLIC_URL}/browse/s/${prevId}`);\n        } else {\n          history.push(`${process.env.PUBLIC_URL}/browse/${prevId}`);\n        }\n      } else if (prevAction == \"c\") {\n        history.push(`${process.env.PUBLIC_URL}/collection`);\n      } else {\n        history.push(`${process.env.PUBLIC_URL}/browse`);\n      }\n    }\n  }\n\n  return (\n    <div>\n      {!open\n        ?\n        (<div>\n          <div className=\"page\"><br /><Centered><StyledSpinnerNext /></Centered></div>\n        </div>)\n        :\n        (<PhotoSwipe\n          container={browserItems}\n          onIndexChange={updateIndex}\n          onOpenChange={setOpened.bind(this)}\n          index={index}\n          open={open}\n          options={options}\n          theme={{\n            foreground: '#ffffff',\n            background: '#000000',\n          }}\n        />)\n\n      }\n    </div>\n  )\n}\n\nexport default withRouter(Reader);\n","import preval from 'preval.macro';\nimport {\n    Modal,\n    ModalHeader,\n    ModalBody,\n    ModalFooter,\n    ModalButton,\n    ROLE,\n    SIZE\n} from 'baseui/modal';\n\nimport { Link } from 'react-router-dom';\n\nconst About = (props) => {\n    const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`\n\n    return (\n        <Modal\n            isOpen={props.isOpen}\n            onClose={() => props.onClose()}\n            closeable\n            animate\n            autoFocus\n            size={SIZE.default}\n            role={ROLE.dialog}>\n            <ModalHeader>LoboReader<br />for Internet Archive</ModalHeader>\n            <ModalBody>\n                Build date: {dateTimeStamp}<br /><br />\n                LoboReader is an unofficial reader for the Internet Archive \"Magazine Rack\".<br/><br/>\n                For changelog, docs &amp; licensing please visit project page on GitHub.\n            </ModalBody>\n            <ModalFooter>\n            <Link to={{ pathname: \"https://github.com/gitGalu/LoboReader\" }} target=\"_blank\"><ModalButton kind=\"primiary\">Visit GitHub</ModalButton></Link>\n            </ModalFooter>\n        </Modal>\n    )\n}\n\nexport default About;\n","import {\n    Modal,\n    ModalHeader,\n    ModalBody,\n    ROLE,\n    SIZE\n} from 'baseui/modal';\n\nimport {\n    StyledBody,\n  } from \"baseui/card\";\n\nconst StandaloneWarning = (props) => {\n    return (\n        <Modal\n            isOpen={true}\n            closeable={false}\n            animate\n            size={SIZE.default}\n            role={ROLE.alertdialog}>\n            <ModalHeader>LoboReader<br />for Internet Archive</ModalHeader>\n            <ModalBody className=\"doubleSpace\">\n               <StyledBody>\n               <p>LoboReader is an unofficial reader for the Internet Archive \"Magazine Rack\".</p>\n               <p></p>\n               <p>You have to add it to your Home screen and launch it from the app icon:</p>\n               <ul>\n               <li>When using Safari (iOS and iPadOS), tap the Share button and select \"Add to Home Screen\".</li>\n               <li>When using Chrome (Android), tap the menu overflow button (three dots) and select \"Add to Home screen\".</li>\n               </ul>\n               </StyledBody>\n            </ModalBody>\n        </Modal>\n    )\n}\n\nexport default StandaloneWarning;\n","import React from 'react';\nimport { Helmet } from 'react-helmet';\nimport { Route, Switch, withRouter, Link, NavLink } from 'react-router-dom';\nimport { HeaderNavigation, ALIGN, StyledNavigationList, StyledNavigationItem } from 'baseui/header-navigation';\nimport { Button, KIND } from 'baseui/button';\nimport { StatefulButtonGroup, MODE } from 'baseui/button-group';\nimport { SnackbarProvider, PLACEMENT } from 'baseui/snackbar';\nimport { Layer } from 'baseui/layer';\nimport Browser from './Routes/Browser';\nimport Collection from './Routes/Collection';\nimport Reader from './Routes/Reader';\nimport About from './Components/About';\nimport StandaloneWarning from './Components/StandaloneWarning';\nimport './App.css';\n\nconst App = (props) => {\n    const [isOpen, setOpen] = React.useState(false);\n\n    const isStandalone = () => {\n        return (window.matchMedia('(display-mode: standalone)').matches);\n    }\n\n    return (\n        !isStandalone()\n            ?\n            <StandaloneWarning />\n            :\n            <SnackbarProvider placement={PLACEMENT.top}>\n                <Helmet>\n                    <meta charSet=\"utf-8\" />\n                    <title>LoboReader</title>\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"></meta>\n                    <meta name=\"robots\" content=\"noindex\" />\n                </Helmet>\n                <About isOpen={isOpen} onClose={() => setOpen(false)}></About>\n                <Layer>\n                    <div className=\"anchored-top\">\n                        <HeaderNavigation\n                            overrides={{\n                                Root: {\n                                    style: {\n                                        height: '48px',\n                                    }\n                                }\n                            }}>\n                            <StyledNavigationList>\n                                <StyledNavigationItem className=\"header\">\n                                    <div>LoboReader</div></StyledNavigationItem>\n                            </StyledNavigationList>\n                            <StyledNavigationList $align={ALIGN.center} />\n                            <StyledNavigationList $align={ALIGN.right}>\n                                <StyledNavigationItem>\n                                    <Link to=\"#\">\n                                        <div\n                                            className=\"header\"\n                                            style={{\n                                                float: 'right',\n                                                marginRight: '16px',\n                                                marginTop: '-4px',\n                                                fontSize: '75%'\n                                            }}\n                                            onClick={() => setOpen(s => !s)}>\n                                            About\n                                </div>\n                                    </Link>\n                                </StyledNavigationItem>\n                            </StyledNavigationList>\n                        </HeaderNavigation>\n                        <div className=\"menuBar\">\n                            <StatefulButtonGroup\n                                mode={MODE.radio}\n                                initialState={{ selected: 0 }}>\n                                <NavLink\n                                    to={`${process.env.PUBLIC_URL}/browse`}\n                                    isActive={(match, location) => {\n                                        if (match || ('/LoboReader' === location.pathname || '/LoboReader/' === location.pathname)) {\n                                            return true;\n                                        }\n                                    }}\n                                    activeClassName=\"menuActive\">\n                                    <Button\n                                        kind={KIND.tertiary}>Browse</Button>\n                                </NavLink>\n                                <NavLink\n                                    to={`${process.env.PUBLIC_URL}/collection`}\n                                    isActive={(match, location) => {\n                                        return match;\n                                    }}\n                                    activeClassName=\"menuActive\">\n                                    <Button kind={KIND.tertiary}>Collection</Button>\n                                </NavLink>\n                            </StatefulButtonGroup>\n                        </div>\n                    </div>\n                </Layer>\n\n                <div className=\"container\">\n                    <Switch>\n                        <Route exact path={`${process.env.PUBLIC_URL}/`} component={Browser} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/browse/s/:searchQuery`} component={Browser} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/browse/:id`} component={Browser} />\n                        <Route path={`${process.env.PUBLIC_URL}/browse`} component={Browser} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/collection`} component={Collection} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/read/:id`} component={Reader} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/read/:id/p/:prevAction`} component={Reader} />\n                        <Route exact path={`${process.env.PUBLIC_URL}/read/:id/p/:prevAction/:prevId`} component={Reader} />\n                        <Route default component={Browser} />\n                    </Switch>\n                </div>\n            </SnackbarProvider>\n    );\n}\n\nexport default withRouter(App)","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Client as Styletron } from 'styletron-engine-atomic';\nimport { Provider as StyletronProvider } from 'styletron-react';\nimport { LightTheme, BaseProvider } from 'baseui';\nimport App from './App/App';\n\nReactDOM.render(\n  <StyletronProvider value={new Styletron()}>\n    <BaseProvider theme={LightTheme}>\n      <BrowserRouter>\n        <App />\n      </BrowserRouter>\n    </BaseProvider>\n  </StyletronProvider>\n  ,\n  document.getElementById('root')\n);"],"sourceRoot":""}